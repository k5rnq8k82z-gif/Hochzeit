<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kim & Partner â€“ Hochzeit</title>
  <meta name="description" content="Hochzeit von Kim & Partner â€“ RSVP, Infos & Galerie" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #0f1115;
      --card: rgba(255,255,255,0.08);
      --fg: #e8eaf2;
      --muted:#aab0c0;
      --brand:#ff89a8;
      --brand2:#8ac6ff;
      --ok:#39d353;
      --warn:#ffcc00;
      --error:#ff6b6b;
      --shadow: 0 10px 30px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.06);
      --radius: 14px;
    }
    * { box-sizing: border-box; }
    html,body { margin:0; padding:0; background: radial-gradient(1200px 800px at 10% 0%, #1a1d26, #0f1115) no-repeat; color:var(--fg); font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
    a { color: var(--brand2); text-decoration: none; }
    img { max-width:100%; display:block; }

    /* Splash */
    #splash{
      position:fixed; inset:0; z-index:1000;
      background: #000 url('img/hero.jpg') center/cover no-repeat; /* <-- ersetze Bild */
      display:grid; place-items:center;
      transition: opacity .8s ease;
    }
    #splash::after{
      content:"";
      position:absolute; inset:0;
      background: linear-gradient(180deg, rgba(0,0,0,.3), rgba(0,0,0,.6));
    }
    #splash .title{
      position:relative; z-index:2; text-align:center;
      padding:16px 28px; border-radius:999px;
      background: rgba(255,255,255,.12); backdrop-filter: blur(8px);
      box-shadow: var(--shadow);
      font-weight:700; letter-spacing:.5px;
    }
    #splash.hide{ opacity:0; pointer-events:none; }

    /* Header / Nav */
    header{
      position:sticky; top:0; z-index:20;
      background:rgba(15,17,21,.6); backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .wrap{ max-width:1100px; margin:0 auto; padding:20px; }
    nav{ display:flex; align-items:center; gap:14px; justify-content:space-between; }
    .brand{ display:flex; align-items:center; gap:12px; font-weight:700; }
    .brand .dot{ width:10px; height:10px; border-radius:50%; background: linear-gradient(135deg, var(--brand), var(--brand2)); box-shadow:0 0 20px var(--brand); }
    .navlinks a{ padding:8px 12px; border-radius:10px; }
    .navlinks a:hover{ background:rgba(255,255,255,.06); }

    /* Hero */
    .hero{ padding:64px 20px 24px; text-align:center; }
    .hero h1{ font-size: clamp(28px, 5vw, 48px); margin:0 0 8px; }
    .hero p{ color:var(--muted); margin:0; }

    /* Sections */
    section{ padding:28px 20px 10px; }
    .card{
      background: var(--card);
      border: 1px solid rgba(255,255,255,.08);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 20px;
    }
    .grid{
      display:grid; gap:18px;
      grid-template-columns: repeat(12, 1fr);
    }
    .col-12{ grid-column: span 12; }
    .col-6{ grid-column: span 12; }
    @media(min-width:860px){ .col-6{ grid-column: span 6; } }

    /* Form */
    form label{ display:block; font-weight:600; margin:12px 0 6px; }
    input[type="text"], input[type="email"], textarea, select{
      width:100%; padding:12px 14px; border-radius:12px;
      border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.06); color:var(--fg);
      outline:none;
    }
    textarea{ min-height:90px; resize:vertical; }
    .row{ display:flex; gap:12px; flex-wrap:wrap; }
    .row > *{ flex:1; min-width:160px; }
    .radios{ display:flex; gap:12px; }
    .chip{
      display:inline-flex; align-items:center; gap:8px; padding:10px 14px;
      border-radius:999px; border:1px solid rgba(255,255,255,.12); cursor:pointer;
      background:rgba(255,255,255,.04);
    }
    .chip input{ display:none; }
    .chip[data-checked="true"]{ outline:2px solid rgba(255,255,255,.18); background:rgba(255,255,255,.10); }
    .hint{ color:var(--muted); font-size:14px; }
    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:10px;
      border:0; padding:12px 16px; border-radius:12px; cursor:pointer; font-weight:700;
      color:#0c0f14; background:linear-gradient(135deg, var(--brand), var(--brand2));
      box-shadow: 0 10px 20px rgba(255,137,168,.25), 0 6px 18px rgba(138,198,255,.18);
    }
    .btn.ghost{ background: transparent; color:var(--fg); border:1px solid rgba(255,255,255,.18); }
    .success{ color: var(--ok); font-weight:600; }
    .error{ color: var(--error); font-weight:600; }

    /* Info list */
    ul.clean{ list-style:none; padding:0; margin:0; display:grid; gap:10px; }
    ul.clean li{
      padding:12px 14px; border-radius:12px; background:rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.08);
    }

    /* Gallery */
    .gallery{
      display:grid; gap:10px;
      grid-template-columns: repeat(2, 1fr);
    }
    @media(min-width:700px){ .gallery{ grid-template-columns: repeat(4, 1fr); } }
    .gallery img{ border-radius:12px; aspect-ratio: 1/1; object-fit:cover; }

    footer{ padding:60px 20px; text-align:center; color:var(--muted); }
  </style>
</head>
<body>

  <!-- Splash mit Foto, blendet automatisch aus -->
  <div id="splash" aria-hidden="true">
    <div class="title">Kim &amp; Partner â€¢ 20. Juni 2026</div>
  </div>

  <header>
    <div class="wrap">
      <nav>
        <div class="brand"><span class="dot"></span> <span>Hochzeit</span></div>
        <div class="navlinks">
          <a href="#rsvp">Check-in</a>
          <a href="#infos">Infos</a>
          <a href="#galerie">Galerie</a>
        </div>
      </nav>
    </div>
  </header>

  <main>
    <div class="wrap hero">
      <h1>Willkommen zur Hochzeit von Kim &amp; Partner</h1>
      <p>Wir freuen uns riesig, dass ihr da seid! Nutzt den Check-in, um eure Zusage zu geben und Infos zu erhalten.</p>
    </div>

    <section id="rsvp">
      <div class="wrap grid">
        <div class="col-6">
          <div class="card">
            <h2 style="margin-top:0">Check-in / Zusage</h2>
            <p class="hint">Bitte fÃ¼llt die Felder aus. Ihr kÃ¶nnt eine Begleitperson angeben.</p>

            <!-- Netlify Forms Registratur + Honeypot -->
            <form id="rsvpForm"
                  name="rsvp"
                  method="post"
                  action="/success.html"
                  data-netlify="true"
                  netlify-honeypot="bot-field"
                  novalidate>
              <input type="hidden" name="form-name" value="rsvp" />
              <p style="display:none;">
                <label>Bitte freilassen: <input name="bot-field" /></label>
              </p>

              <label for="name">Vor- &amp; Nachname *</label>
              <input id="name" name="name" type="text" placeholder="Max Mustermann" required>

              <div class="row">
                <div>
                  <label>Teilnahme *</label>
                  <div class="radios" id="attendingRadios" role="radiogroup" aria-label="Teilnahme">
                    <label class="chip" data-chip>
                      <input type="radio" name="attending" value="ja" required>
                      <span>Ich komme</span>
                    </label>
                    <label class="chip" data-chip>
                      <input type="radio" name="attending" value="nein">
                      <span>Kann leider nicht</span>
                    </label>
                  </div>
                </div>
                <div>
                  <label for="guests">Begleitperson(en)</label>
                  <select id="guests" name="guests">
                    <option value="0" selected>Keine</option>
                    <option value="1">1 Person</option>
                    <option value="2">2 Personen</option>
                    <option value="3">3 Personen</option>
                    <option value="4">4 Personen</option>
                  </select>
                </div>
              </div>

              <label for="email">E-Mail (optional)</label>
              <input id="email" name="email" type="email" placeholder="max@example.com" inputmode="email" autocomplete="email">

              <label for="message">Nachricht (optional)</label>
              <textarea id="message" name="message" placeholder="Allergien, MusikwÃ¼nsche, sonstige Hinweise â€¦"></textarea>

              <label class="hint" style="display:flex; align-items:center; gap:10px; margin-top:12px;">
                <input type="checkbox" id="privacy" required>
                <span>Ich stimme zu, dass meine Angaben zur Organisation der Hochzeit verarbeitet werden.</span>
              </label>

              <div class="row" style="margin-top:14px;">
                <button class="btn" type="submit">Einchecken</button>
                <button class="btn ghost" type="button" id="resetBtn">ZurÃ¼cksetzen</button>
              </div>
              <p id="status" role="status" style="margin-top:10px;"></p>
              <noscript><p class="hint">Hinweis: Ohne JavaScript wirst du auf die Danke-Seite weitergeleitet.</p></noscript>
            </form>
          </div>
        </div>

        <div class="col-6">
          <div class="card">
            <h2 style="margin-top:0">Ablauf &amp; Ort</h2>
            <ul class="clean">
              <li><strong>Datum:</strong> 20. Juni 2026</li>
              <li><strong>Trauung:</strong> 14:00 Uhr, Standesamt Innenstadt</li>
              <li><strong>Feier:</strong> ab 16:00 Uhr, Gutshof Sonnental</li>
              <li><strong>Dresscode:</strong> Festlich, sommerlich</li>
              <li><strong>Anfahrt:</strong> ParkplÃ¤tze am Gutshof, Ã–PNV: Linie 4 bis â€žSonnentalâ€œ</li>
              <li><strong>Ãœbernachtung:</strong> Hotel Rosengarten (Stichwort â€žHochzeit Kimâ€œ)</li>
            </ul>
            <p class="hint" style="margin-top:10px">
              QR-Code: Er fÃ¼hrt direkt auf diese Seite â€“ einfach scannen.
            </p>
          </div>
        </div>

      </div>
    </section>

    <section id="infos">
      <div class="wrap grid">
        <div class="col-12">
          <div class="card">
            <h2 style="margin-top:0">Weitere Informationen</h2>
            <p>Hier findet ihr Antworten zu Geschenken, Kindern, Fotobox usw. â€“ und natÃ¼rlich aktualisieren wir die Seite laufend.</p>
            <ul class="clean">
              <li><strong>Geschenke:</strong> Das grÃ¶ÃŸte Geschenk seid ihr. Wer dennoch etwas geben mÃ¶chte: <em>Reisekasse</em> ðŸ˜Š</li>
              <li><strong>Kinder:</strong> Sehr gern! Es gibt eine Spielecke im Garten.</li>
              <li><strong>Fotos:</strong> Nach der Feier teilen wir hier eine Galerie. Hashtag <span class="mono">#KimUndPartner</span>.</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <section id="galerie">
      <div class="wrap grid">
        <div class="col-12">
          <div class="card">
            <h2 style="margin-top:0">Galerie</h2>
            <div class="gallery" id="gallery">
              <!-- Eigene Bilder in /img/ ablegen -->
              <img src="img/pic1.jpg" alt="Bild 1" loading="lazy">
              <img src="img/pic2.jpg" alt="Bild 2" loading="lazy">
              <img src="img/pic3.jpg" alt="Bild 3" loading="lazy">
              <img src="img/pic4.jpg" alt="Bild 4" loading="lazy">
            </div>
            <p class="hint" style="margin-top:10px">Tipp: Nach der Feier kÃ¶nnt ihr hier weitere Bilder ergÃ¤nzen.</p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    Mit Liebe gemacht. Â© Kim &amp; Partner
  </footer>

  <script>
    // ---------- Splash ausblenden ----------
    const splash = document.getElementById('splash');
    const hideSplash = () => splash.classList.add('hide');
    window.addEventListener('load', () => setTimeout(hideSplash, 2200));
    splash.addEventListener('click', hideSplash);

    // ---------- Chips (Radio UI) ----------
    document.querySelectorAll('[data-chip]').forEach(label => {
      const input = label.querySelector('input[type="radio"]');
      input.addEventListener('change', () => {
        label.parentElement.querySelectorAll('[data-chip]').forEach(l => l.dataset.checked = 'false');
        label.dataset.checked = 'true';
      });
    });

    // ---------- CONFIG: Google Sheets Web-App ----------
    // Trage hier deine Apps-Script Web-App-URL & dein Token ein:
    const SHEET_ENDPOINT = "YOUR_SHEET_ENDPOINT_HERE";   // z.B. https://script.google.com/macros/s/AKfyc.../exec
    const SHEET_TOKEN    = "YOUR_ADMIN_TOKEN_HERE";       // fÃ¼r Admin-Ansicht (?admin=1&token=...)

    // ---------- Netlify Forms: Helper fÃ¼r Fallback ----------
    const encode = (data) =>
      Object.keys(data).map(k => encodeURIComponent(k) + "=" + encodeURIComponent(data[k])).join("&");

    // ---------- Admin: bei ?admin=1&token=XYZ Tabelle zeigen ----------
    const params = new URLSearchParams(location.search);
    const IS_ADMIN = params.get('admin') === '1';
    const ADMIN_TOKEN = params.get('token') || "";

    function mountAdminUI() {
      const wrap = document.querySelector('#rsvp .wrap');
      const div = document.createElement('div');
      div.className = 'col-12';
      div.innerHTML = `
        <div class="card">
          <div style="display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap;">
            <strong>Veranstalter-Ãœbersicht</strong>
            <div>
              <button class="btn ghost" id="admRefresh" type="button">Aktualisieren</button>
              <button class="btn ghost" id="admCsv" type="button">CSV exportieren</button>
            </div>
          </div>
          <div style="overflow:auto; margin-top:12px;">
            <table id="admTable" aria-label="RSVP-Tabelle">
              <thead>
                <tr>
                  <th>Zeit</th><th>Name</th><th>Zusage</th><th>Begleitung</th><th>E-Mail</th><th>Nachricht</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <p class="hint mono" id="admHint" style="margin-top:8px;"></p>
        </div>
      `;
      wrap.appendChild(div);

      document.getElementById('admRefresh').addEventListener('click', loadAdmin);
      document.getElementById('admCsv').addEventListener('click', exportCsv);
    }

    async function loadAdmin() {
      const hint = document.getElementById('admHint');
      const tbody = document.querySelector('#admTable tbody');
      if (!SHEET_ENDPOINT || !ADMIN_TOKEN) {
        hint.textContent = 'Fehlende Konfiguration (Endpoint/Token).';
        return;
      }
      hint.textContent = 'Lade...';
      tbody.innerHTML = '';
      try {
        const url = `${SHEET_ENDPOINT}?token=${encodeURIComponent(ADMIN_TOKEN)}`;
        const res = await fetch(url, { method: 'GET' });
        const json = await res.json();
        if (!json.ok) throw new Error(json.error || 'Fehler');
        const rows = json.rows || [];
        for (const r of rows) {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td class="mono">${r.timestamp || ''}</td>
            <td>${r.name || ''}</td>
            <td>${r.attending === 'ja' ? 'Zusage' : (r.attending || '')}</td>
            <td>${r.guests || ''}</td>
            <td>${r.email || ''}</td>
            <td>${r.message || ''}</td>
          `;
          tbody.appendChild(tr);
        }
        hint.textContent = \`EintrÃ¤ge: \${rows.length}\`;
      } catch (err) {
        console.error(err);
        hint.textContent = 'Konnte Daten nicht laden.';
      }
    }

    function exportCsv() {
      const rows = Array.from(document.querySelectorAll('#admTable tbody tr')).map(tr =>
        Array.from(tr.children).map(td => td.textContent));
      const header = ['timestamp','name','attending','guests','email','message'];
      const esc = v => \`"\${String(v ?? '').replace(/"/g,'""')}"\`;
      const lines = [header.join(',')].concat(rows.map(r => r.map(esc).join(',')));
      const blob = new Blob([lines.join('\n')], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const a = Object.assign(document.createElement('a'), { href: url, download: 'rsvps.csv' });
      document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    }

    if (IS_ADMIN) {
      mountAdminUI();
      loadAdmin();
    }

    // ---------- Submit-Logik: 1) Google Sheets, 2) Fallback Netlify Forms ----------
    const form = document.getElementById('rsvpForm');
    const statusEl = document.getElementById('status');
    const resetBtn = document.getElementById('resetBtn');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      statusEl.textContent = "";

      const name = (document.getElementById('name').value || "").trim();
      const email = (document.getElementById('email').value || "").trim();
      const message = (document.getElementById('message').value || "").trim();
      const guests = document.getElementById('guests').value;
      const attending = (new FormData(form).get('attending') || "").toString();
      const privacy = document.getElementById('privacy').checked;

      if(!name || !attending || !privacy){
        statusEl.textContent = "Bitte fÃ¼lle Name, Teilnahme & Datenschutz aus.";
        statusEl.className = "error";
        return;
      }

      const bot = (new FormData(form).get('bot-field') || "").toString();
      if (bot) return;

      // --- 1) Sheets schreiben ---
      let sheetOk = false;
      if (SHEET_ENDPOINT && SHEET_ENDPOINT.startsWith('http')) {
        try {
          const payload = new URLSearchParams({
            name, email, message, guests, attending,
            ua: navigator.userAgent
          });
          const res = await fetch(SHEET_ENDPOINT, {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8" },
            body: payload.toString()
          });
          const json = await res.json();
          sheetOk = !!json.ok;
        } catch (err) {
          console.warn('Sheets-Fehler:', err);
        }
      }

      // --- 2) Netlify Forms Fallback ---
      if (!sheetOk) {
        try {
          const res2 = await fetch("/", {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: encode({ "form-name": "rsvp", name, email, message, guests, attending })
          });
          if (!res2.ok) throw new Error("Netlify Submit Fehler");
        } catch (err2) {
          statusEl.textContent = "Ups â€“ Online-Speichern hat nicht geklappt. Bitte spÃ¤ter erneut senden.";
          statusEl.className = "error";
          console.error(err2);
          return;
        }
      }

      statusEl.textContent = attending === 'ja'
        ? "Danke fÃ¼r deine Zusage! ðŸŽ‰"
        : "Schade, aber danke fÃ¼rs Bescheid sagen!";
      statusEl.className = "success";
      form.reset();
      document.querySelectorAll('[data-chip]').forEach(l => l.dataset.checked = 'false');
    });

    resetBtn.addEventListener('click', () => {
      form.reset();
      document.querySelectorAll('[data-chip]').forEach(l => l.dataset.checked = 'false');
      statusEl.textContent = "";
      statusEl.className = "";
    });
  </script>
</body>
</html>
