<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Kim & Partner ‚Äì Hochzeit in Thailand</title>
  <meta name="description" content="Hochzeit von Kim & Partner in Thailand ‚Äì RSVP, Infos, Galerie & Chat" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Playfair+Display:wght@500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      /* Helle, reduzierte Palette ‚Äì abgestimmt aufs Foto */
      --sand-50:#fffdf8; --sand-100:#fbf3e7; --blush-50:#f7eee9;
      --gold:#b48a4a; --gold-soft:#d8c19a; --sea:#78cfd2;
      --ink:#3e2f26; --muted:#7b7169;
      --paper:#ffffff; --card:rgba(255,255,255,.92);
      --shadow:0 14px 36px rgba(76,60,46,.10);
      --radius:16px;
      --ok:#2ea85f; --warn:#d79b00; --error:#e86a6a;
    }

    *{box-sizing:border-box}
    html,body{
      margin:0; padding:0; color:var(--ink);
      font-family:Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background:
        radial-gradient(1200px 600px at 0% -10%, rgba(244,230,211,.35), transparent 60%),
        radial-gradient(900px 520px at 110% 10%, rgba(247,238,233,.45), transparent 60%),
        linear-gradient(180deg, #fffdf8 0%, #fffaf2 100%);
      min-height:100vh;
    }
    a{ color:var(--gold); text-decoration:none }

    /* Header */
    header{
      position:sticky; top:0; z-index:20;
      background:rgba(255,255,255,.8); backdrop-filter: blur(12px);
      border-bottom:1px solid rgba(60,45,32,.10);
    }
    .wrap{ max-width:1100px; margin:0 auto; padding:20px }
    nav{ display:flex; align-items:center; justify-content:space-between; gap:14px }
    .brand{ display:flex; align-items:center; gap:12px; font-weight:800; letter-spacing:.3px; color:var(--ink); font-family:"Playfair Display", ui-serif, Georgia, serif; }
    .brand .dot{ width:12px; height:12px; border-radius:999px; background:conic-gradient(from 45deg, var(--gold), var(--sea), var(--gold-soft)); border:1px solid rgba(212,179,116,.55); box-shadow:0 0 16px rgba(212,179,116,.65) }
    .navlinks a{ padding:8px 12px; border-radius:10px; color:#5b4a3b; font-weight:600 }
    .navlinks a:hover{ background:rgba(212,179,116,.14) }

    /* HERO ‚Äì echtes IMG, kein Cropping */
    .hero{ padding:0 20px; margin:18px auto 6px; max-width:1100px }
    .hero-frame{
      background:var(--card); border:1px solid rgba(60,45,32,.10);
      border-radius:22px; box-shadow:var(--shadow);
      padding:14px; overflow:hidden;
    }
    .hero-img{
      width:100%; height:auto; display:block; border-radius:14px;
      /* Kein Zuschnitt: skaliert proportional */
    }
    .hero-note{
      display:flex; gap:14px; align-items:center; justify-content:space-between; flex-wrap:wrap;
      padding:12px 2px 0; color:var(--muted);
    }
    .pill{
      display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px;
      background:linear-gradient(180deg,#fff,#fff7ee);
      border:1px solid rgba(212,179,116,.45); color:#6d5330; font-weight:700;
    }
    .hero-title{
      margin:0; font-family:"Playfair Display", ui-serif, Georgia, serif;
      color:#7a5b2f; font-size:clamp(24px,4.5vw,34px); letter-spacing:.2px;
    }

    section{ padding:28px 20px 18px }
    .card{
      background:var(--card); backdrop-filter: blur(6px);
      border:1px solid rgba(60,45,32,.10);
      border-radius:var(--radius); box-shadow:var(--shadow); padding:22px;
    }
    .grid{ display:grid; gap:18px; grid-template-columns:repeat(12,1fr) }
    .col-12{ grid-column:span 12 }
    .col-6{ grid-column:span 12 }
    @media(min-width:860px){ .col-6{ grid-column:span 6 } }

    /* Form */
    form label{ display:block; font-weight:700; margin:12px 0 6px; color:#4a382a }
    input[type="text"], input[type="email"], input[type="date"], textarea, select{
      width:100%; padding:12px 14px; border-radius:12px; background:#fff; color:var(--ink);
      border:1px solid rgba(60,45,32,.16); outline:none; transition:border-color .2s, box-shadow .2s;
    }
    input:focus, textarea:focus, select:focus{ border-color:rgba(212,179,116,.65); box-shadow:0 0 0 6px rgba(212,179,116,.16) }
    textarea{ min-height:100px; resize:vertical }
    .row{ display:flex; gap:12px; flex-wrap:wrap }
    .row > *{ flex:1; min-width:160px }
    .radios{ display:flex; gap:12px; flex-wrap:wrap }
    .chip{ display:inline-flex; align-items:center; gap:10px; padding:10px 14px; cursor:pointer; border-radius:999px; background:#fff; border:1px solid rgba(60,45,32,.16); font-weight:600; color:#4a3f36; transition: transform .12s, box-shadow .2s, border-color .2s }
    .chip:hover{ transform:translateY(-1px); box-shadow:0 8px 16px rgba(76,60,46,.08) }
    .chip input{ display:none }
    .chip[data-checked="true"]{ border-color:rgba(212,179,116,.75); box-shadow:0 0 0 6px rgba(212,179,116,.16); background:linear-gradient(180deg,#fff,#fff7ee) }

    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:10px; cursor:pointer;
      padding:12px 16px; border-radius:14px; border:1px solid rgba(212,179,116,.55);
      font-weight:800; color:#5b4527;
      background:linear-gradient(135deg,#fff2dc,#fee7e4);
      box-shadow:0 8px 20px rgba(212,179,116,.22), 0 6px 18px rgba(120,207,210,.12);
      transition: transform .12s, box-shadow .2s, filter .2s;
    }
    .btn:hover{ transform:translateY(-1px); box-shadow:0 14px 26px rgba(212,179,116,.22); filter:brightness(1.02) }
    .btn.ghost{ background:#fff; color:#4a3a30; border:1px solid rgba(60,45,32,.16); box-shadow:none }

    .success{ color:var(--ok); font-weight:700 }
    .error{ color:var(--error); font-weight:700 }
    .hint{ color:var(--muted); font-size:14px }
    ul.clean{ list-style:none; padding-left:0; margin:0; display:grid; gap:8px }
    ul.clean li::before{ content:"‚ùñ"; margin-right:8px; color:var(--gold) }

    /* Galerie/Lightbox */
    .gallery{ display:grid; gap:10px; grid-template-columns:repeat(2,1fr) }
    @media(min-width:700px){ .gallery{ grid-template-columns:repeat(4,1fr) } }
    .gallery img{ border-radius:14px; aspect-ratio:1/1; object-fit:cover; cursor:pointer; border:1px solid rgba(60,45,32,.10); box-shadow:0 8px 20px rgba(76,60,46,.06); transition:transform .2s, box-shadow .2s, filter .2s }
    .gallery img:hover{ transform:translateY(-2px) scale(1.01); box-shadow:0 14px 28px rgba(76,60,46,.10); filter:saturate(1.05) }

    .lightbox{ position:fixed; inset:0; background:rgba(255,255,255,.92); display:none; align-items:center; justify-content:center; z-index:50; backdrop-filter:blur(4px) }
    .lightbox.show{ display:flex }
    .lightbox img{ max-width:90vw; max-height:80vh; border-radius:16px; background:#fff; border:1px solid rgba(60,45,32,.12); box-shadow:0 30px 60px rgba(76,60,46,.18) }
    .lightbox .close{ position:absolute; top:14px; right:18px; font-size:28px; cursor:pointer; color:#4a3a2f; background:#fff; border-radius:999px; padding:4px 12px; border:1px solid rgba(60,45,32,.12); box-shadow:var(--shadow) }

    footer{ padding:60px 20px; text-align:center; color:var(--muted); font-size:14px }
    .divider{ height:1px; background:linear-gradient(90deg, transparent, rgba(60,45,32,.12), transparent); margin:22px 0 }
  </style>
</head>
<body>
  <!-- HERO ‚Äì kein Zuschnitt, clean integriert -->
  <section class="hero">
    <div class="hero-frame">
      <img class="hero-img" src="img/hero.jpg" alt="Save the Date ‚Äì Koh Samui">
      <div class="hero-note">
        <h2 class="hero-title">SAVE THE DATE ‚Ä¢ 01. Juni 2026 ‚Ä¢ Koh Samui</h2>
        <div class="pill">üíå Dresscode: Festlich & sommerlich</div>
      </div>
    </div>
  </section>

  <header>
    <div class="wrap">
      <nav>
        <div class="brand"><span class="dot"></span><span>Hochzeit</span></div>
        <div class="navlinks">
          <a href="#rsvp">Check-in</a>
          <a href="#infos">Infos</a>
          <a href="#galerie">Galerie</a>
          <a href="#chat">G√§stebuch</a>
          <a href="admin.html" title="Verwaltung">Admin</a>
        </div>
      </nav>
    </div>
  </header>

  <main>
    <section id="rsvp">
      <div class="wrap grid">
        <div class="col-6">
          <div class="card">
            <h2 style="margin-top:0; font-family:'Playfair Display', ui-serif, Georgia, serif; color:#7a5b2f;">Check-in / Zusage</h2>
            <p class="hint">Bitte tragt euren Geburtstag (YYYY-MM-DD) ein. Bei Begleitungen ebenfalls das Geburtsdatum.</p>

            <form id="rsvpForm" name="rsvp" method="post" action="/" data-netlify="true" netlify-honeypot="bot-field" novalidate>
              <input type="hidden" name="form-name" value="rsvp" />
              <p style="display:none;"><label>Bitte freilassen: <input name="bot-field" /></label></p>

              <label for="name">Vor- &amp; Nachname *</label>
              <input id="name" name="name" type="text" placeholder="Max Mustermann" required autocomplete="name" autocapitalize="words">

              <label for="birthday">Geburtstag *</label>
              <input id="birthday" name="birthday" type="date" required>

              <div class="row">
                <div>
                  <label>Teilnahme *</label>
                  <div class="radios" id="attendingRadios" role="radiogroup" aria-label="Teilnahme">
                    <label class="chip" data-chip><input type="radio" name="attending" value="ja" required><span>Ich komme</span></label>
                    <label class="chip" data-chip><input type="radio" name="attending" value="nein"><span>Kann leider nicht</span></label>
                  </div>
                </div>
                <div>
                  <label for="guests">Anzahl Begleitpersonen</label>
                  <select id="guests" name="guests">
                    <option value="0" selected>0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                  </select>
                </div>
              </div>

              <div id="companions">
                <div class="row">
                  <div><label for="c1name">Begleitung 1 ‚Äì Name</label><input id="c1name" type="text" placeholder="Vor- & Nachname"></div>
                  <div><label for="c1dob">Geburtstag</label><input id="c1dob" type="date"></div>
                </div>
                <div class="row">
                  <div><label for="c2name">Begleitung 2 ‚Äì Name</label><input id="c2name" type="text"></div>
                  <div><label for="c2dob">Geburtstag</label><input id="c2dob" type="date"></div>
                </div>
                <div class="row">
                  <div><label for="c3name">Begleitung 3 ‚Äì Name</label><input id="c3name" type="text"></div>
                  <div><label for="c3dob">Geburtstag</label><input id="c3dob" type="date"></div>
                </div>
                <div class="row">
                  <div><label for="c4name">Begleitung 4 ‚Äì Name</label><input id="c4name" type="text"></div>
                  <div><label for="c4dob">Geburtstag</label><input id="c4dob" type="date"></div>
                </div>
              </div>

              <label for="email">E-Mail (optional)</label>
              <input id="email" name="email" type="email" placeholder="max@example.com" inputmode="email" autocomplete="email">

              <label for="message">Nachricht (optional)</label>
              <textarea id="message" name="message" placeholder="Allergien, Musikw√ºnsche, Hinweise ‚Ä¶"></textarea>

              <label class="hint" style="display:flex; align-items:center; gap:10px; margin-top:12px;">
                <input type="checkbox" id="privacy" required>
                <span>Ich stimme zu, dass meine Angaben zur Organisation der Hochzeit verarbeitet werden.</span>
              </label>

              <div class="row" style="margin-top:14px;">
                <button class="btn" type="submit" id="submitBtn">Einchecken</button>
                <button class="btn ghost" type="button" id="resetBtn">Zur√ºcksetzen</button>
              </div>
              <p id="status" role="status" style="margin-top:10px;"></p>
            </form>
          </div>
        </div>

        <div class="col-6">
          <div class="card">
            <h2 style="margin-top:0; font-family:'Playfair Display', ui-serif, Georgia, serif; color:#7a5b2f;">Ablauf &amp; Ort</h2>
            <ul class="clean">
              <li><strong>Datum:</strong> 01. Juni 2026</li>
              <li><strong>Trauung:</strong> 14:00 Uhr, Strandzeremonie Koh Samui</li>
              <li><strong>Feier:</strong> ab 16:00 Uhr, Beach Resort</li>
              <li><strong>Dresscode:</strong> Festlich, sommerlich</li>
              <li><strong>Anfahrt:</strong> Shuttle vom Hotel ‚Ä¢ Taxis verf√ºgbar</li>
              <li><strong>√úbernachtung:</strong> Resort-Kontingent (Stichwort ‚ÄûHochzeit Kim‚Äú)</li>
            </ul>
            <div class="divider"></div>
            <p class="hint">QR-Code: Er f√ºhrt direkt auf diese Seite ‚Äì einfach scannen.</p>
          </div>
        </div>
      </div>
    </section>

    <section id="infos">
      <div class="wrap grid">
        <div class="col-12">
          <div class="card">
            <h2 style="margin-top:0; font-family:'Playfair Display', ui-serif, Georgia, serif; color:#7a5b2f;">Weitere Informationen</h2>
            <p>Thailand-Flair, Palmen & Sonnenuntergang ‚Äì wir freuen uns auf einen unvergesslichen Tag mit euch! üáπüá≠üåÖ</p>
            <ul class="clean">
              <li><strong>Geschenke:</strong> Eure Anwesenheit ist unser Geschenk. Wer mag: <em>Reisekasse</em> üíû</li>
              <li><strong>Kinder:</strong> Sehr gern! Kinderbetreuung am Strand.</li>
              <li><strong>Fotos:</strong> Nach der Feier f√ºllen wir die Galerie. Hashtag <span class="mono">#KimUndPartnerInThailand</span></li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <section id="galerie">
      <div class="wrap grid">
        <div class="col-12">
          <div class="card">
            <h2 style="margin-top:0; font-family:'Playfair Display', ui-serif, Georgia, serif; color:#7a5b2f;">Galerie</h2>
            <div class="gallery" id="gallery">
              <img src="img/pic1.jpg" alt="Strand">
              <img src="img/pic2.jpg" alt="Palmen">
              <img src="img/pic3.jpg" alt="Thailand">
              <img src="img/pic4.jpg" alt="Sonnenuntergang">
            </div>
            <p class="hint" style="margin-top:10px">Tipp: Bild antippen ‚Äì Lightbox √∂ffnet sich.</p>
          </div>
        </div>
      </div>
      <div class="lightbox" id="lightbox"><span class="close" id="lbClose">‚úï</span><img id="lbImg" alt=""></div>
    </section>

    <section id="chat">
      <div class="wrap grid">
        <div class="col-12">
          <div class="card">
            <h2 style="margin-top:0; font-family:'Playfair Display', ui-serif, Georgia, serif; color:#7a5b2f;">G√§stebuch / Chat üí¨</h2>
            <p class="hint">Hinterlasst uns gern eine liebe Nachricht! (√ñffentlich sichtbar)</p>
            <div class="row">
              <input id="chatName" type="text" placeholder="Dein Name">
              <input id="chatText" type="text" placeholder="Deine Nachricht ‚Ä¶" />
              <button class="btn" id="chatSend">Senden</button>
            </div>
            <p id="chatStatus" class="hint" style="margin-top:8px;"></p>
            <div id="chatList" style="margin-top:14px; display:grid; gap:10px;"></div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>Mit Liebe gemacht. ¬© Kim &amp; Partner</footer>

  <script>
    const SHEET_ENDPOINT = "https://script.google.com/macros/s/AKfycbxb4kqalumOxwfAQkbOIyI3yUjFNaRo-LJsNOyx6UCHGw2WQ12-rh9sjBgocuDIBbwf/exec";

    /* Chips togglen */
    document.querySelectorAll('[data-chip]').forEach(label => {
      const input = label.querySelector('input[type="radio"]');
      input.addEventListener('change', () => {
        label.parentElement.querySelectorAll('[data-chip]').forEach(l => l.dataset.checked = 'false');
        label.dataset.checked = 'true';
      });
    });

    /* Lightbox */
    const lb = document.getElementById('lightbox');
    const lbImg = document.getElementById('lbImg');
    document.getElementById('gallery').addEventListener('click', (e) => {
      if (e.target.tagName === 'IMG') { lbImg.src = e.target.src; lb.classList.add('show'); }
    });
    document.getElementById('lbClose').addEventListener('click', () => lb.classList.remove('show'));
    lb.addEventListener('click', (e) => { if (e.target === lb) lb.classList.remove('show'); });

    /* RSVP */
    const form = document.getElementById('rsvpForm');
    const statusEl = document.getElementById('status');
    const resetBtn = document.getElementById('resetBtn');
    const submitBtn = document.getElementById('submitBtn');

    resetBtn?.addEventListener('click', () => {
      form.reset();
      document.querySelectorAll('[data-chip]').forEach(l => l.dataset.checked = 'false');
      statusEl.textContent = ""; statusEl.className = "";
    });

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      statusEl.textContent = ""; statusEl.className = "";

      if (!SHEET_ENDPOINT || !SHEET_ENDPOINT.startsWith('https')) {
        statusEl.textContent = "Konfiguration fehlt: SHEET_ENDPOINT ist nicht gesetzt.";
        statusEl.className = "error"; return;
      }

      const name = (document.getElementById('name').value || "").trim();
      const birthday = (document.getElementById('birthday').value || "").trim(); // YYYY-MM-DD
      const email = (document.getElementById('email').value || "").trim();
      const message = (document.getElementById('message').value || "").trim();
      const guests = document.getElementById('guests').value;
      const attending = (new FormData(form).get('attending') || "").toString();
      const privacy = document.getElementById('privacy').checked;

      if(!name || !birthday || !attending || !privacy){
        statusEl.textContent = "Bitte f√ºlle Name, Geburtstag, Teilnahme & Datenschutz aus.";
        statusEl.className = "error"; return;
      }

      /* === Mapping f√ºr vorhandenes Sheet ===
         - Name -> "Max Mustermann (YYYY-MM-DD)"
         - Begleit-Geburtstage in die bisherigen *Age*-Felder (c1age..c4age)
      */
      const nameWithDob = `${name} (${birthday})`;
      const c1name = (document.getElementById('c1name').value || "");
      const c2name = (document.getElementById('c2name').value || "");
      const c3name = (document.getElementById('c3name').value || "");
      const c4name = (document.getElementById('c4name').value || "");
      const c1dob  = (document.getElementById('c1dob').value  || "");
      const c2dob  = (document.getElementById('c2dob').value  || "");
      const c3dob  = (document.getElementById('c3dob').value  || "");
      const c4dob  = (document.getElementById('c4dob').value  || "");

      const payload = new URLSearchParams({
        type:"rsvp",
        name: nameWithDob, email, message, guests, attending,
        c1name, c1age: c1dob,
        c2name, c2age: c2dob,
        c3name, c3age: c3dob,
        c4name, c4age: c4dob,
        ua: navigator.userAgent
      });

      try{
        submitBtn && (submitBtn.disabled = true);
        statusEl.textContent = "Sende ‚Ä¶";
        const res = await fetch(SHEET_ENDPOINT, {
          method:"POST",
          headers:{ "Content-Type":"application/x-www-form-urlencoded;charset=UTF-8" },
          body: payload.toString()
        });
        if(!res.ok) throw new Error("HTTP "+res.status);
        let ok = true;
        try{ const j = await res.json(); ok = !!j.ok; if(!ok && j.error) throw new Error(j.error); }catch(_){}
        if(ok){
          statusEl.textContent = attending === 'ja' ? "Danke f√ºr deine Zusage! ‚ú®" : "Schade, aber danke f√ºrs Bescheid sagen! üíå";
          statusEl.className = "success";
          form.reset(); document.querySelectorAll('[data-chip]').forEach(l => l.dataset.checked = 'false');
        } else throw new Error("Antwort nicht best√§tigt");
      }catch(err){
        console.error(err);
        statusEl.textContent = "Speichern fehlgeschlagen. Bitte Apps Script aktualisieren (type=rsvp).";
        statusEl.className = "error";
      }finally{ submitBtn && (submitBtn.disabled = false); }
    });

    /* Chat (unver√§ndert) */
    const chatName = document.getElementById('chatName');
    const chatText = document.getElementById('chatText');
    const chatSend = document.getElementById('chatSend');
    const chatList = document.getElementById('chatList');
    const chatStatus = document.getElementById('chatStatus');

    chatSend.addEventListener('click', async () => {
      chatStatus.textContent = "";
      const n=(chatName.value||"").trim(), t=(chatText.value||"").trim();
      if(!n||!t){ chatStatus.textContent="Bitte Name und Nachricht eingeben."; return; }
      try{
        const res = await fetch(SHEET_ENDPOINT, {
          method:"POST",
          headers:{ "Content-Type":"application/x-www-form-urlencoded;charset=UTF-8" },
          body:new URLSearchParams({ type:"chat", name:n, message:t, ua:navigator.userAgent }).toString()
        });
        if(!res.ok) throw new Error();
        chatText.value=""; chatStatus.textContent="Gesendet üí¨"; loadChat();
      }catch(e){ chatStatus.textContent="Chat speichern fehlgeschlagen (Apps Script type=chat)."; }
    });

    async function loadChat(){
      chatList.innerHTML="";
      try{
        const url = new URL(SHEET_ENDPOINT); url.searchParams.set("type","chat"); url.searchParams.set("list","1");
        const res = await fetch(url,{method:"GET"}); const j = await res.json();
        if(!j.ok) throw new Error(j.error||"Fehler");
        (j.rows||[]).slice(-40).forEach(r=>{
          const card=document.createElement('div'); card.className="card";
          const esc=s=>String(s||'').replace(/[<>&"]/g, s=>({'<':'&lt;','>':'&gt;','&':'&amp;','"':'&quot;'}[s]));
          card.innerHTML=`<strong>${esc(r.name)||'Gast'}</strong><div class="hint" style="margin-top:4px;">${esc(r.message)}</div>`;
          chatList.appendChild(card);
        });
      }catch(e){ chatStatus.textContent="Chat laden nicht m√∂glich (GET im Apps Script)."; }
    }
    loadChat();
  </script>
</body>
</html>
